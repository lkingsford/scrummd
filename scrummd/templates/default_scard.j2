{%- if interactive -%}
    {%- set HEADER = "\x1b[31m" -%}
    {%- set TITLE = "\x1b[36m" -%}
    {%- set RESET = "\x1b[0m" -%}
    {%- set BOLD = "\x1b[1m" -%}
    {%- set MISSING = "\x1b[31;1m" -%}
    {%- set DIM = "\x1b[38;5;237m" -%} {# 256 color term - most should be good, the rest will ignore #}
    {%- set BRIGHT = "\x1b[1m" -%}
{%- else -%}
    {%- set HEADER = "" -%}
    {%- set TITLE = "" -%}
    {%- set RESET = "" -%}
    {%- set BOLD = "" -%}
    {%- set RED = "" -%}
    {%- set DIM = "" -%}
    {%- set BRIGHT = "" -%}
{%- endif -%}
{%- macro card_ref(component) -%}
    {%- if component.card is not none -%}
        {{ BOLD }}[[{{ component.card_index }}]]{{ RESET }}
    {%- else -%}
        {{ MISSING }}[[{{ component.card_index }} - MISSING]]{{ RESET }}
    {%- endif -%}
{%- endmacro -%}
{%- macro code_block(component) -%}
{{ DIM }}```{{ RESET }}{{ BRIGHT }}{{component.value}}{{ RESET }}{{ DIM }}```{{ RESET }}
{%- endmacro -%}
{%- macro code_quote(component) -%}
{{ DIM }}`{{ RESET }}{{ BRIGHT }}{{component.value}}{{ RESET }}{{ DIM }}`{{ RESET }}
{%- endmacro -%}
---
{{ TITLE }}{{ card.index }}: {{ card.summary }}{{ RESET }}
---
{% for key, value in card.udf.items() -%}
    {% if value is none -%}
    {% elif value is string -%}
        {% if "\n" in value %}
{{ HEADER }}# {{ key }}{{ RESET }}

{{ value | apply_field_macros() }}
        {%- else %}
{{ HEADER }}{{ key }}{{ RESET }}: {{ value | apply_field_macros() }}
        {%- endif -%}
    {%- elif value is number -%}
{{ HEADER }}{{ key }}{{ RESET }}: {{ "%.2f"|format(value) }}
    {%- elif value is iterable %}
{{ HEADER }}# {{ key }}{{ RESET }}
        {% for item in value %}
  - {{ item -}}
        {% endfor %}
    {% endif %}
{% endfor %}
